# 策划文档

此文档记录策划思路以及工作安排

## 2017年7月21日，Friday

接下来需要完成的任务:

1. 优化编辑器,尤其是地图编辑器和怪物数值编辑器,以便后续能够方便设置数值
1. 优化事件结构，把部分数据挪到拥有事件的对象或者地图位置上
1. 继续完成事件,主要是地图传送事件、道具事件和选择事件，另外还要为一次性事件添加自移除机制
1. 优化已完成的事件，主要是对话事件和战斗事件的屏幕适配
1. 优化JsonParser, 采用就地截取制,或者干脆把Json处理成Binary,用Binary读取,总之要提高配置读取速度
1. 优化UI资源，使其更美观
1. 为战斗添加跳数字标志和Miss标志，更正美术资源
1. 简略设置一批数值，然后集中Debug已完成的功能
1. 整理代码格式和框架结构，添加必要的注释
1. 打出android包和iOS包，通过功能测试和适配测试
1. 添加几个大型动画资源，例如开场动画，VS boss动画等

## 2017年8月23日，Wednesday

+ 事件结构已优化, 基本通过测试
+ 地图编辑器的bug已修复, 现在可以正常编辑地图了
+ 获取基本资源型道具的事件已完成, 需要进一步测试（在2楼摆放更多物品进行测试）
+ 跨地图传送事件已通过测试，但是有一个BUG（见下）
+ 怪物数据编辑器需要进行便利性优化, 这是接下来要进行的工作
+ BUG: 重要级，跨地图第一次传送时，由于载入延迟，导致角色传送后多走了一步
+ BUG: 一般级，退出地图编辑器然后进入游戏时，报错，无法正常游戏
+ BUG: 轻微级，开门时，仍然可以继续触发开门事件（会继续扣钥匙并重复播放音效），应加入一个开门loading状态来解决此问题

## 2017年8月24日, Thursday

1. 完成loading幕布的动画
1. 解决开门事件重复触发的BUG
1. **完成choice事件的功能**
1. 对对话框, 战斗框和选择框进行适配和UI优化, 添加跳数字和跳Miss的效果
1. 对前几层进行正式的内容规划设计, 并反复测试功能和体验
1. 优化数据读取(如20170721中第5点所述)
1. 配置好android包, ios包和 win-app-store的包, 尝试打包
1. 整理代码结构, 添加必要注释

## 2017年9月14日, Thursday

1. 对对话框, 战斗框和选择框进行适配和UI优化, 添加跳数字和跳Miss的效果
1. **完成choice事件的功能**
1. 对前几层进行正式的内容规划设计, 并反复测试功能和体验
1. 整理代码结构, 添加必要注释
1. 优化数据读取(如20170721中第5点所述)
1. 配置好android包, ios包和 win-app-store的包, 尝试打包

## 2017年9月29日，Friday

1. 完成CallEventAt事件和CannotMove事件
1. 完成部分道具的实际效果数值及首次Tips提示
1. 继续对对话框, 战斗框和选择框进行适配和UI优化, 添加跳数字和跳Miss的效果
1. **完成choice事件的功能**，完成商店功能
1. 继续设计前几层的内容，补充剧情，调整设计和数值, 并反复测试功能和体验
1. 整理代码结构, 添加必要注释
1. 优化数据读取(如20170721中第5点所述)
1. 配置好android包, ios包和 win-app-store的包, 尝试打包

## 2018年3月16日, Friday
1. 关于choice事件功能,有如下工作需要继续完成:
 + ~~按钮响应功能~~ (2018.3.17)
 + ~~选项间距适配~~ (2018.4.19)
 + 整个choice框的高度适配, 以及语言文本框部分的高度适配, 可能需要与字体大小适配一起进行
 + speaker头像修正,及位置适配
 + 选项指示, 快捷键
 + 选项文本内容的数值replace
 + 更丰富的选取和选择特效, 例如颜色变化, 音效等
 + 字体大小的适配, 框位置的适配
2. 关于战斗框, 有如下工作需要完成:
 + 字体大小适配, 框位置的适配
 + 战斗失败功能
 + 框大小的适配, 长宽比不要太大
 + 中途撤退功能, 暂停功能, 插入对话功能
 + 战斗胜利和战斗失败音效
 + 战斗结果提示修正
 + 资源替换
 + 跳数字, 跳miss的资源,音效及功能
3. 关于对话框和tips框, 有如下工作需要完成:
 + ~~字体大小适配, 框位置的适配~~ (2018.4.25)(2018.6.13 完成了框位置的随屏幕缩放适配)
4. 关于传送功能, 有如下工作需要完成:
 + curtain内容添加(楼层, 传送时选择功能, 将来还会添加传送时缩略地图, 还有就是Esc主菜单提示)
 + curtain淡入淡出功能
 + 传送音效, 同层传送角色淡入淡出功能
 + 测试传送阵跨地图传送功能
5. 完成部分道具的实际效果数值及首次Tips提示
1. 设计前11层的内容, 补充对话和商店功能, 测试体验
1. 配置好android包, ios包和 win-app-store的包, 尝试打包
1. 整理代码结构, 添加必要注释, 把MainScene里过于臃肿的功能代码尝试分离出来, 各种对话框可以尝试分离成prefab
1. 添加几个大型动画资源，例如开场动画，VS boss动画等

## 2018年3月17日, Saturday
1. 修复了choice按钮响应的bug, bug产生原因是: 按钮被curtain挡住; 解决方法是: 让curtain隐藏, 即SetActive(false), 在需要显示时再出现
1. 下一项工作: 调整选项的位置和大小适配, 解决选项首次出现时, 选项个数不对的问题

## 2018年4月19日, Thursday
1. 修正了choice按钮的选项列表适配和大小间距适配, 采用了VerticalLayoutGroup控件, 不再使用代码进行适配, 但框的高度仍然用代码适配, 目前在较小高度的屏幕上仍有问题, 需要稍后解决

## 2018年4月24日, Tuesday
1. 已经重构了整个项目代码结构, 进行了更工整的分类, 并且将所有对话框从MainScene中分离了出来. 分离出来的对话框, 功能基本正常, 但是表现上仍有一些头像错误(应该是第一次写时生成头像的代码copy错误)的问题, 需要检查代码. 另外, 适配还没有优化
1. 添加了对象池ObjectPool. 现在, 所有的Prefab, 都加入了对象池
1. 完成了对Android平台以及WebGL平台的打包测试, 可以正常运行. 但WebGL平台有无法显示中文的问题, 以及内存过大(与json读取方式过于低效有关)的问题, 512MB内存仍不能满足, 必须要优化数据读取.
1. 已经优化了初始化方式. 现在, 每个Scene都可以独立初始化, 无需从StartScene进入

## 2018年6月29日, Friday
1. 自动寻路已完成, 仍有如下问题:
 + 终点为不可过物品时仍然不能正常寻路(路径大于2长度)
 + 需要将可过门设为0优先级(完全可过)路径, 同时将带有传送事件的地方设置为9优先级(不可过)路径, 否则传送事件会使自动寻路出问题
 + 安卓手机上关于事件触发和Touch判定有着各种各样奇怪的bug, 需要专门针对性调试, 找出问题原因, 不确定iOS上是否有此类问题